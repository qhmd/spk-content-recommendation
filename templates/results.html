{% extends "base.html" %}
{% block title %}Hasil — Content DSS{% endblock %}
{% block content %}
<div class="space-y-6">
  <div class="flex items-start ">
    <h3 class="text-lg font-semibold">Hasil Perhitungan</h3>
    <a href="{{ url_for('input_data') }}"
       class="ml-2 px-3 py-2 bg-panel rounded text-sm">Ubah Data</a>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
    <div class="p-4 rounded-lg bg-white/5">
      <h4 class="font-semibold mb-3">Ringkasan</h4>
      <div class="text-sm text-gray-300/80 space-y-1">
        <p>Alternatif: <strong>{{ names|length }}</strong></p>
        <p>Metode: <strong>SAW → TOPSIS</strong></p>
      </div>

      <div class="mt-4">
        <h5 class="text-md font-bold mb-2">Bobot</h5>
        <ul class="space-y-2">
          {% for i in range(criteria|length) %}
          <li class="flex items-start justify-between text-sm">
            <div>{{ criteria[i] }}</div>
            <div class="font-semibold">
                {{ '%g'|format(weights[i]*100) }}%
                </div>

          </li>
          {% endfor %}
        </ul>
      </div>
    </div>

    <div class="lg:col-span-2 p-4 rounded-lg bg-white/5 overflow-x-auto">
      <h4 class="font-semibold mb-3">Ranking Akhir</h4>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        {% for item in ranking %}
        <div class="p-3 rounded-lg bg-[linear-gradient(90deg,#0f1724,#102231)] border border-white/6">
          <div class="flex items-start justify-between">
            <div>
              <div class="text-xs text-gray-300/70">#{{ item.rank }}</div>
              <div class="text-lg font-semibold">{{ item.name }}</div>
            </div>
            <div class="text-right">
              <div class="text-sm text-gray-300/70">Score</div>
              <div class="text-xl font-bold accent-text">
                {{ ('%.4f'|format(item.score)) }}
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <div class="p-4 rounded-lg bg-white/5 overflow-auto">
    <h4 class="font-semibold mb-3">Detail Matriks &amp; Perhitungan</h4>

        <!-- NORMALISASI NILAI -->
    <div class="mb-3">
    <h5 class="text-sm font-medium">Normalisasi Nilai</h5>
    <div class="overflow-x-auto mt-2">
        <table class="w-full text-sm text-left">
        <thead>
            <tr class="text-left">
            <th class="px-2 py-1">Alternatif</th>
            {% for c in criteria %}
                <th class="px-2 py-1">{{ c }}</th>
            {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for i in range(names|length) %}
            <tr>
            <td class="py-1 px-2">{{ names[i] }}</td>
            {% for val in R_saw[i] %}
                <td class="px-2">{{ ('%.4f'|format(val)) }}</td>
            {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
    </div>
    <br>

    <!-- NORMALISASI TERBOBOT -->
    <div class="mb-3">
    <h5 class="text-sm font-medium">Normalisasi Terbobot</h5>
    <div class="overflow-x-auto mt-2">
        <table class="w-full text-sm text-left">
        <thead>
            <tr class="text-left">
            <th class="px-2 py-1">Alternatif</th>
            {% for c in criteria %}
                <th class="px-2 py-1">{{ c }}</th>
            {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for i in range(names|length) %}
            <tr>
            <td class="py-1 px-2">{{ names[i] }}</td>
            {% for val in Y[i] %}
                <td class="px-2">{{ ('%.6f'|format(val)) }}</td>
            {% endfor %}
            </tr>
            {% endfor %}
            <tr class="border-t">
            <td class="py-2 px-2 font-semibold">Ideal+</td>
            {% for v in ideal_pos %}
                <td class="px-2 font-semibold">{{ ('%.6f'|format(v)) }}</td>
            {% endfor %}
            </tr>
            <tr>
            <td class="py-2 px-2 font-semibold">Ideal−</td>
            {% for v in ideal_neg %}
                <td class="px-2 font-semibold">{{ ('%.6f'|format(v)) }}</td>
            {% endfor %}
            </tr>
        </tbody>
        </table>
    </div>
    </div>

    <br>
    <!-- DISTANCE & SCORE -->
    <div>
    <h5 class="text-sm font-medium">Distance &amp; Score</h5>
    <div class="overflow-x-auto mt-2">
        <table class="w-full text-sm text-left">
        <thead>
            <tr class="text-left">
            <th class="px-2 py-1">Alternatif</th>
            <th class="px-2 py-1">D+</th>
            <th class="px-2 py-1">D−</th>
            <th class="px-2 py-1">Score V</th>
            </tr>
        </thead>
        <tbody>
            {% for i in range(names|length) %}
            <tr>
            <td class="py-1 px-2">{{ names[i] }}</td>
            <td class="px-2">{{ ('%.6f'|format(D_pos[i])) }}</td>
            <td class="px-2">{{ ('%.6f'|format(D_neg[i])) }}</td>
            <td class="px-2 font-semibold">{{ ('%.6f'|format(score[i])) }}</td>
            </tr>
            {% endfor %}
        </tbody>
        </table>
    </div>
    </div>

</div>
{% endblock %}
